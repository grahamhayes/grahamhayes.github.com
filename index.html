<!DOCTYPE html>
<html prefix="
og: http://ogp.me/ns#
article: http://ogp.me/ns/article#
" lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="Weird (sometimes incoherent) rambling of a developer.">
<meta name="viewport" content="width=device-width">
<title>graham.hayes.ie | graham.hayes.ie</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
<link rel="canonical" href="http://graham.hayes.ie/">
<!--[if lt IE 9]><script src="/assets/js/html5.js"></script><![endif]-->
</head>
<body>
    <section class="social"><ul>
<a href="."><img style="border-radius: 50%; margin-left: auto; margin-right: auto; display: block; margin-bottom: 20px" width="80" height="80" src="images/me.jpg"></a>
                    <li><a href="." title="Home"><i class="icon-home"></i></a></li>
            <li><a href="archive.html" title="Archives"><i class="icon-folder-open-alt"></i></a></li>
            <li><a href="categories" title="Tags"><i class="icon-tags"></i></a></li>
            <li><a href="projects" title="Projects"><i class="icon-briefcase"></i></a></li>
            <li><a href="stories/about-me" title="About Me"><i class="icon-info"></i></a></li>
            <li><a href="rss.xml" title="RSS"><i class="icon-rss"></i></a></li>
            <li><a href="https://twitter.com/grahamhayes" title="My Twitter"><i class="icon-twitter"></i></a></li>
            <li><a href="https://github.com/grahamhayes" title="My Github"><i class="icon-github"></i></a></li>

        </ul></section><section class="page-content"><div class="content" rel="main">
        <div class="post">
            <h1 class="title"><a href="posts/designate-mid-cycle/">Designate Mid Cycle</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2016-02-24T22:55:00+00:00">2016-02-24 22:55</time>
</div>
                <div class="stats">
                                <a href="posts/designate-mid-cycle/#disqus_thread" data-disqus-identifier="cache/posts/designate-mid-cycle.html">Comments</a>


                </div>
                        <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/galway/" rel="tag">galway</a></li>
           <li><a class="tag p-category" href="categories/openstack/" rel="tag">openstack</a></li>
           <li><a class="tag p-category" href="categories/summit/" rel="tag">summit</a></li>
           <li><a class="tag p-category" href="categories/travel/" rel="tag">travel</a></li>
        </ul>
</div>

            </div>
            <div class="body">
                <div>
<img alt="http://photos.gra.ham.ie/Designate-Mid-Cycle/i-S96NrNb/0/O/IMG_3854.jpg" src="http://photos.gra.ham.ie/Designate-Mid-Cycle/i-S96NrNb/0/O/IMG_3854.jpg"><div class="section" id="designate-mid-cycle">
<h2>Designate Mid Cycle</h2>
<p>This was a little over a week ago, and I have been trying to get my thoughts down on
paper /  rst.</p>
<p>It was a good few days overall - we had our usual arguements about implementation of some
familiar features, we listed out reasons that our past selves were wrong about everything,
and how we should fix our mistakes.</p>
<!-- TEASER_END -->
<p>We actually kicked off a day earlier than expected - using a big table in the lobby of
the hotel as a confernce room :)</p>
<img alt="https://pbs.twimg.com/media/CaoO47bWcAAzjU7.jpg:large" src="https://pbs.twimg.com/media/CaoO47bWcAAzjU7.jpg:large"><p><em>Unoffical Day 0 conference room</em></p>
<p>We planned what we thought we were going to do, and how long we thought it would
take - roughly. We had gathered feedback about what topics were important before hand on
an <a class="reference external" href="https://etherpad.openstack.org/p/designate_2016_winter_midcycle_meetup">etherpad</a> so we broke it down into half day buckets, while trying to avoid getting
into the discussion there and then. (Which, as you can imagine, is a lot easier said than done)</p>
<div class="section" id="monday">
<h3>Monday</h3>
<p>One of the most contraversial (based on how we would implment it) proposals was
<a class="reference external" href="https://twitter.com/timsimmons_">timsim</a>'s Worker Model.</p>
<p>We had started to build bespoke services to cover different needs,
(pool-manager and zone-manager for starters) but it causes issues when we try to give
scaling advice to people, as some will need more zone-manager's while others will
need more mini-dns and pool-manager instances.</p>
<p>Tim had a very good spec for this - it is under final review <a class="reference external" href="https://review.openstack.org/#q,I731bab1b2c24a6f2c9392698914a6b09c12765af,n,z">here</a></p>
<p>From that spec the new designate would be:</p>
<div class="section" id="new-architecture">
<h4>New  Architecture</h4>
<ul class="simple">
<li>
<tt class="docutils literal"><span class="pre">designate-api</span></tt> - To receive JSON and parse it for Designate</li>
<li>
<tt class="docutils literal"><span class="pre">designate-central</span></tt> - To do validation/storage of zone/record data and
send send CRUD tasks to <tt class="docutils literal"><span class="pre">designate-worker</span></tt>.</li>
<li>
<tt class="docutils literal"><span class="pre">designate-mdns</span></tt> - To <strong>only</strong> perfrom AXFRs from Designate's database</li>
<li>
<tt class="docutils literal"><span class="pre">designate-worker</span></tt> - Any and all tasks that Designate needs to
produce state on nameservers</li>
<li>
<tt class="docutils literal"><span class="pre">designate-producer</span></tt> - To run periodic/timed jobs, and produce work
for <tt class="docutils literal"><span class="pre">designate-worker</span></tt> that is out the normal path of API operations.
For example: Periodic recovery.</li>
</ul>
<p>Other necessary components:</p>
<ul class="simple">
<li>Queue - Usually RabbitMQ</li>
<li>Database - Usually MySQL</li>
<li>Cache - (encouraged, although not necessary) Memcached, MySQL, Redis</li>
<li>A <tt class="docutils literal">tooz</tt> backend (Zookeeper, Memcached, Redis)</li>
</ul>
<p>This also has the nice side effect of no longer needing a mini-dns RPCAPI.
Long term, we all acknowledge that we will need to rewrite the mini-dns component
in something faster (Go, C/C++, Rust have all been proposed), and having to
write a compatibility layer for oslo.messaging in another language was not a small
task. <a class="footnote-reference" href="posts/designate-mid-cycle/#id3" id="id1">[1]</a></p>
<p>It allows mini-dns to just worry about serving DNS data (like a DNS Server should).</p>
</div>
<div class="section" id="nih-syndrome-or-efficient">
<h4>NIH Syndrome or Efficient ?</h4>
<p>The next item up was "how ?". We have multiple libraries availible for doing
distributed tasks - there is even one in OpenStack itself - <a class="reference external" href="http://docs.openstack.org/developer/taskflow/">TaskFlow</a> .</p>
<p>There was discomfort over using the extra complexity of TaskFlow vs a small
homegrown system that could just use tools like olso.messaging and rpc casts.</p>
<p>For this we had to try and map out the "flows" for each of our tasks. We
realised that some of our flows actually had a lot more moving parts than we expected</p>
<img alt="http://photos.gra.ham.ie/Designate-Mid-Cycle/i-MkDmj2D/0/L/IMG_3847-3-L.jpg" src="http://photos.gra.ham.ie/Designate-Mid-Cycle/i-MkDmj2D/0/L/IMG_3847-3-L.jpg"><p><em>a flow that was more complex than we expected</em></p>
<p>This is where the majority of the discussion went - there were proposals for many
libraries, and for writing our own. We decided that we should do some base
implementation testing later on in the week.</p>
<p>The session notes are here: <a class="reference external" href="https://etherpad.openstack.org/p/designate_2016_winter_midcycle_meetup_workers">mid-cycle-workers</a></p>
</div>
</div>
<div class="section" id="tuesday">
<h3>Tuesday</h3>
<p>We ran though a few proposals that were had implementation questions like
how we avoid the <strong>stampeding herd</strong> problem for nameserver changes. These were
done with fairly easily.</p>
<p>We also agreed on a few API additions (no breaking changes :))</p>
<div class="section" id="api-changes">
<h4>API Changes</h4>
<div class="section" id="new-resource-at-the-base-of-the-api">
<h5>New Resource at the base of the API</h5>
<p>We agreed to add a new <em>/recordsets</em>  endpoint, which will show a user all the
recordsets that they have across all zones.</p>
<p>This will allow users to filter across all recordsets for data, for example if
a user wanted to see where they had used 8.8.8.8 they could do the following:</p>
<pre class="code http"><a name="rest_code_8f51c08279f340b8a5349f6c32e3465f-1"></a><span class="nf">GET</span> <span class="nn">http://127.0.0.1:9001/v2/recordsets?data=8.8.8.8</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<a name="rest_code_8f51c08279f340b8a5349f6c32e3465f-2"></a><span class="na">Host</span><span class="o">:</span> <span class="l">127.0.0.1:9001</span>
<a name="rest_code_8f51c08279f340b8a5349f6c32e3465f-3"></a><span class="na">Accept</span><span class="o">:</span> <span class="l">application/json</span>
<a name="rest_code_8f51c08279f340b8a5349f6c32e3465f-4"></a><span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/json</span>
</pre>
<pre class="code http"><a name="rest_code_72c4a5d217aa4cc3bcb66f4504a9066a-1"></a><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<a name="rest_code_72c4a5d217aa4cc3bcb66f4504a9066a-2"></a><span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/json</span>
<a name="rest_code_72c4a5d217aa4cc3bcb66f4504a9066a-3"></a>
<a name="rest_code_72c4a5d217aa4cc3bcb66f4504a9066a-4"></a><span class="p">{</span>
<a name="rest_code_72c4a5d217aa4cc3bcb66f4504a9066a-5"></a>    <span class="nt">"recordsets"</span><span class="p">:</span> <span class="p">[</span>
<a name="rest_code_72c4a5d217aa4cc3bcb66f4504a9066a-6"></a>        <span class="p">{</span>
<a name="rest_code_72c4a5d217aa4cc3bcb66f4504a9066a-7"></a>            <span class="nt">"description"</span><span class="p">:</span> <span class="s2">"This is an example record set."</span><span class="p">,</span>
<a name="rest_code_72c4a5d217aa4cc3bcb66f4504a9066a-8"></a>            <span class="nt">"links"</span><span class="p">:</span> <span class="p">{</span>
<a name="rest_code_72c4a5d217aa4cc3bcb66f4504a9066a-9"></a>                <span class="nt">"self"</span><span class="p">:</span> <span class="s2">"https://127.0.0.1:9001/v2/zones/2150b1bf-dee2-4221-9d85-11f7886fb15f/recordsets/f7b10e9b-0cae-4a91-b162-562bc6096648"</span>
<a name="rest_code_72c4a5d217aa4cc3bcb66f4504a9066a-10"></a>            <span class="p">},</span>
<a name="rest_code_72c4a5d217aa4cc3bcb66f4504a9066a-11"></a>            <span class="nt">"updated_at"</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
<a name="rest_code_72c4a5d217aa4cc3bcb66f4504a9066a-12"></a>            <span class="nt">"records"</span><span class="p">:</span> <span class="p">[</span>
<a name="rest_code_72c4a5d217aa4cc3bcb66f4504a9066a-13"></a>                <span class="s2">"8.8.8.8"</span>
<a name="rest_code_72c4a5d217aa4cc3bcb66f4504a9066a-14"></a>            <span class="p">],</span>
<a name="rest_code_72c4a5d217aa4cc3bcb66f4504a9066a-15"></a>            <span class="nt">"ttl"</span><span class="p">:</span> <span class="mi">3600</span><span class="p">,</span>
<a name="rest_code_72c4a5d217aa4cc3bcb66f4504a9066a-16"></a>            <span class="nt">"id"</span><span class="p">:</span> <span class="s2">"f7b10e9b-0cae-4a91-b162-562bc6096648"</span><span class="p">,</span>
<a name="rest_code_72c4a5d217aa4cc3bcb66f4504a9066a-17"></a>            <span class="nt">"name"</span><span class="p">:</span> <span class="s2">"service.other-example.net."</span><span class="p">,</span>
<a name="rest_code_72c4a5d217aa4cc3bcb66f4504a9066a-18"></a>            <span class="nt">"zone_id"</span><span class="p">:</span> <span class="s2">"2150b1bf-dee2-4221-9d85-11f7886fb15f"</span><span class="p">,</span>
<a name="rest_code_72c4a5d217aa4cc3bcb66f4504a9066a-19"></a>            <span class="nt">"created_at"</span><span class="p">:</span> <span class="s2">"2010-01-54T17:49:27.000000"</span><span class="p">,</span>
<a name="rest_code_72c4a5d217aa4cc3bcb66f4504a9066a-20"></a>            <span class="nt">"version"</span><span class="p">:</span> <span class="mi">13</span><span class="p">,</span>
<a name="rest_code_72c4a5d217aa4cc3bcb66f4504a9066a-21"></a>            <span class="nt">"type"</span><span class="p">:</span> <span class="s2">"A"</span>
<a name="rest_code_72c4a5d217aa4cc3bcb66f4504a9066a-22"></a>        <span class="p">},</span>
<a name="rest_code_72c4a5d217aa4cc3bcb66f4504a9066a-23"></a>        <span class="p">{</span>
<a name="rest_code_72c4a5d217aa4cc3bcb66f4504a9066a-24"></a>            <span class="nt">"description"</span><span class="p">:</span> <span class="s2">"This is an example record set."</span><span class="p">,</span>
<a name="rest_code_72c4a5d217aa4cc3bcb66f4504a9066a-25"></a>            <span class="nt">"links"</span><span class="p">:</span> <span class="p">{</span>
<a name="rest_code_72c4a5d217aa4cc3bcb66f4504a9066a-26"></a>                <span class="nt">"self"</span><span class="p">:</span> <span class="s2">"https://127.0.0.1:9001/v2/zones/249502fa-620d-458f-8e29-9ecfc732c357/recordsets/e88f64d0-71ab-423e-9d84-eb8d76b51938"</span>
<a name="rest_code_72c4a5d217aa4cc3bcb66f4504a9066a-27"></a>            <span class="p">},</span>
<a name="rest_code_72c4a5d217aa4cc3bcb66f4504a9066a-28"></a>            <span class="nt">"updated_at"</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
<a name="rest_code_72c4a5d217aa4cc3bcb66f4504a9066a-29"></a>            <span class="nt">"records"</span><span class="p">:</span> <span class="p">[</span>
<a name="rest_code_72c4a5d217aa4cc3bcb66f4504a9066a-30"></a>                <span class="s2">"8.8.8.8"</span>
<a name="rest_code_72c4a5d217aa4cc3bcb66f4504a9066a-31"></a>            <span class="p">],</span>
<a name="rest_code_72c4a5d217aa4cc3bcb66f4504a9066a-32"></a>            <span class="nt">"ttl"</span><span class="p">:</span> <span class="mi">3600</span><span class="p">,</span>
<a name="rest_code_72c4a5d217aa4cc3bcb66f4504a9066a-33"></a>            <span class="nt">"id"</span><span class="p">:</span> <span class="s2">"e88f64d0-71ab-423e-9d84-eb8d76b51938"</span><span class="p">,</span>
<a name="rest_code_72c4a5d217aa4cc3bcb66f4504a9066a-34"></a>            <span class="nt">"name"</span><span class="p">:</span> <span class="s2">"service.example.org."</span><span class="p">,</span>
<a name="rest_code_72c4a5d217aa4cc3bcb66f4504a9066a-35"></a>            <span class="nt">"zone_id"</span><span class="p">:</span> <span class="s2">"249502fa-620d-458f-8e29-9ecfc732c357"</span><span class="p">,</span>
<a name="rest_code_72c4a5d217aa4cc3bcb66f4504a9066a-36"></a>            <span class="nt">"created_at"</span><span class="p">:</span> <span class="s2">"2014-10-24T19:59:44.000000"</span><span class="p">,</span>
<a name="rest_code_72c4a5d217aa4cc3bcb66f4504a9066a-37"></a>            <span class="nt">"version"</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span>
<a name="rest_code_72c4a5d217aa4cc3bcb66f4504a9066a-38"></a>            <span class="nt">"type"</span><span class="p">:</span> <span class="s2">"A"</span>
<a name="rest_code_72c4a5d217aa4cc3bcb66f4504a9066a-39"></a>        <span class="p">}</span>
<a name="rest_code_72c4a5d217aa4cc3bcb66f4504a9066a-40"></a>
<a name="rest_code_72c4a5d217aa4cc3bcb66f4504a9066a-41"></a>    <span class="p">]</span>
<a name="rest_code_72c4a5d217aa4cc3bcb66f4504a9066a-42"></a>
<a name="rest_code_72c4a5d217aa4cc3bcb66f4504a9066a-43"></a><span class="p">}</span>
</pre>
</div>
<div class="section" id="add-serial-to-the-recordset-data">
<h5>Add Serial to the recordset data</h5>
<p>Internally within Designate we track the serial number for the last time a
recordset was updated. We decided to show that in the new response:</p>
<pre class="code json"><a name="rest_code_0a630acb91364020afb0807fcd2f83ea-1"></a><span class="p">{</span>
<a name="rest_code_0a630acb91364020afb0807fcd2f83ea-2"></a>    <span class="nt">"description"</span><span class="p">:</span> <span class="s2">"This is an example record set."</span><span class="p">,</span>
<a name="rest_code_0a630acb91364020afb0807fcd2f83ea-3"></a>    <span class="nt">"links"</span><span class="p">:</span> <span class="p">{</span>
<a name="rest_code_0a630acb91364020afb0807fcd2f83ea-4"></a>        <span class="nt">"self"</span><span class="p">:</span> <span class="s2">"https://127.0.0.1:9001/v2/zones/249502fa-620d-458f-8e29-9ecfc732c357/recordsets/e88f64d0-71ab-423e-9d84-eb8d76b51938"</span>
<a name="rest_code_0a630acb91364020afb0807fcd2f83ea-5"></a>    <span class="p">},</span>
<a name="rest_code_0a630acb91364020afb0807fcd2f83ea-6"></a>    <span class="nt">"updated_at"</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
<a name="rest_code_0a630acb91364020afb0807fcd2f83ea-7"></a>    <span class="nt">"records"</span><span class="p">:</span> <span class="p">[</span>
<a name="rest_code_0a630acb91364020afb0807fcd2f83ea-8"></a>        <span class="s2">"8.8.8.8"</span>
<a name="rest_code_0a630acb91364020afb0807fcd2f83ea-9"></a>    <span class="p">],</span>
<a name="rest_code_0a630acb91364020afb0807fcd2f83ea-10"></a>    <span class="nt">"ttl"</span><span class="p">:</span> <span class="mi">3600</span><span class="p">,</span>
<a name="rest_code_0a630acb91364020afb0807fcd2f83ea-11"></a>    <span class="nt">"id"</span><span class="p">:</span> <span class="s2">"e88f64d0-71ab-423e-9d84-eb8d76b51938"</span><span class="p">,</span>
<a name="rest_code_0a630acb91364020afb0807fcd2f83ea-12"></a>    <span class="nt">"serial"</span><span class="p">:</span> <span class="mi">1456351502</span><span class="p">,</span>
<a name="rest_code_0a630acb91364020afb0807fcd2f83ea-13"></a>    <span class="nt">"name"</span><span class="p">:</span> <span class="s2">"service.example.org."</span><span class="p">,</span>
<a name="rest_code_0a630acb91364020afb0807fcd2f83ea-14"></a>    <span class="nt">"zone_id"</span><span class="p">:</span> <span class="s2">"249502fa-620d-458f-8e29-9ecfc732c357"</span><span class="p">,</span>
<a name="rest_code_0a630acb91364020afb0807fcd2f83ea-15"></a>    <span class="nt">"created_at"</span><span class="p">:</span> <span class="s2">"2014-10-24T19:59:44.000000"</span><span class="p">,</span>
<a name="rest_code_0a630acb91364020afb0807fcd2f83ea-16"></a>    <span class="nt">"version"</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span>
<a name="rest_code_0a630acb91364020afb0807fcd2f83ea-17"></a>    <span class="nt">"type"</span><span class="p">:</span> <span class="s2">"A"</span>
<a name="rest_code_0a630acb91364020afb0807fcd2f83ea-18"></a><span class="p">}</span>
</pre>
</div>
<div class="section" id="structured-data-for-recordsets">
<h5>Structured Data for Recordsets</h5>
<p>And, for the <em>n-th</em> time we looked at structured data.</p>
<p>We have always wanted this - the <a class="reference external" href="https://review.openstack.org/#q,Ie2db550547cb9ed3e95fdd313458ad6332ef34f4,n,z">spec</a> has been around for a while - but we can seem to
find a way to allow for updates to the data.</p>
<p>It would allow us to do some nice things like break the record data up into meaningful
chunks (for people who do not know DNS RFC off the top oof their heads :) ) - for example:</p>
<pre class="code http"><a name="rest_code_26f7858236ec43cfbdb5c16eed9e65b8-1"></a><span class="nf">GET</span> <span class="nn">/v2/zones/2150b1bf-dee2-4221-9d85-11f7886fb15f/recordsets/f7b10e9b-0cae-4a91-b162-562bc6096648</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<a name="rest_code_26f7858236ec43cfbdb5c16eed9e65b8-2"></a><span class="na">Host</span><span class="o">:</span> <span class="l">127.0.0.1:9001</span>
<a name="rest_code_26f7858236ec43cfbdb5c16eed9e65b8-3"></a><span class="na">Accept</span><span class="o">:</span> <span class="l">application/vnd.openstack.dns-v2+json</span>
</pre>
<pre class="code http"><a name="rest_code_9c737830ae0c467f8cde82c8b80ef883-1"></a><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<a name="rest_code_9c737830ae0c467f8cde82c8b80ef883-2"></a><span class="na">Vary</span><span class="o">:</span> <span class="l">Accept</span>
<a name="rest_code_9c737830ae0c467f8cde82c8b80ef883-3"></a><span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/vnd.openstack.dns-v2+json</span>
<a name="rest_code_9c737830ae0c467f8cde82c8b80ef883-4"></a>
<a name="rest_code_9c737830ae0c467f8cde82c8b80ef883-5"></a><span class="p">{</span>
<a name="rest_code_9c737830ae0c467f8cde82c8b80ef883-6"></a>    <span class="nt">"description"</span><span class="p">:</span> <span class="s2">"This is an example recordset."</span><span class="p">,</span>
<a name="rest_code_9c737830ae0c467f8cde82c8b80ef883-7"></a>    <span class="nt">"links"</span><span class="p">:</span> <span class="p">{</span>
<a name="rest_code_9c737830ae0c467f8cde82c8b80ef883-8"></a>        <span class="nt">"self"</span><span class="p">:</span> <span class="s2">"https://127.0.0.1:9001/v2/zones/2150b1bf-dee2-4221-9d85-11f7886fb15f/recordsets/f7b10e9b-0cae-4a91-b162-562bc6096648"</span>
<a name="rest_code_9c737830ae0c467f8cde82c8b80ef883-9"></a>    <span class="p">},</span>
<a name="rest_code_9c737830ae0c467f8cde82c8b80ef883-10"></a>    <span class="nt">"updated_at"</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
<a name="rest_code_9c737830ae0c467f8cde82c8b80ef883-11"></a>    <span class="nt">"records"</span><span class="p">:</span> <span class="p">[</span>
<a name="rest_code_9c737830ae0c467f8cde82c8b80ef883-12"></a>        <span class="p">{</span>
<a name="rest_code_9c737830ae0c467f8cde82c8b80ef883-13"></a>            <span class="nt">"algorithm"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
<a name="rest_code_9c737830ae0c467f8cde82c8b80ef883-14"></a>            <span class="nt">"fp_type"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
<a name="rest_code_9c737830ae0c467f8cde82c8b80ef883-15"></a>            <span class="nt">"fingerprint"</span><span class="p">:</span> <span class="s2">"253d9636219be6aec03d06359837e0604b370372"</span>
<a name="rest_code_9c737830ae0c467f8cde82c8b80ef883-16"></a>        <span class="p">}</span>
<a name="rest_code_9c737830ae0c467f8cde82c8b80ef883-17"></a>    <span class="p">],</span>
<a name="rest_code_9c737830ae0c467f8cde82c8b80ef883-18"></a>    <span class="nt">"ttl"</span><span class="p">:</span> <span class="mi">3600</span><span class="p">,</span>
<a name="rest_code_9c737830ae0c467f8cde82c8b80ef883-19"></a>    <span class="nt">"id"</span><span class="p">:</span> <span class="s2">"f7b10e9b-0cae-4a91-b162-562bc6096648"</span><span class="p">,</span>
<a name="rest_code_9c737830ae0c467f8cde82c8b80ef883-20"></a>    <span class="nt">"name"</span><span class="p">:</span> <span class="s2">"example.org."</span><span class="p">,</span>
<a name="rest_code_9c737830ae0c467f8cde82c8b80ef883-21"></a>    <span class="nt">"zone_id"</span><span class="p">:</span> <span class="s2">"2150b1bf-dee2-4221-9d85-11f7886fb15f"</span><span class="p">,</span>
<a name="rest_code_9c737830ae0c467f8cde82c8b80ef883-22"></a>    <span class="nt">"created_at"</span><span class="p">:</span> <span class="s2">"2014-10-24T19:59:44.000000"</span><span class="p">,</span>
<a name="rest_code_9c737830ae0c467f8cde82c8b80ef883-23"></a>    <span class="nt">"version"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
<a name="rest_code_9c737830ae0c467f8cde82c8b80ef883-24"></a>    <span class="nt">"type"</span><span class="p">:</span> <span class="s2">"SSHFP"</span>
<a name="rest_code_9c737830ae0c467f8cde82c8b80ef883-25"></a><span class="p">}</span>
</pre>
</div>
</div>
<div class="section" id="openstack-ireland-meetup-group">
<h4>OpenStack Ireland Meetup Group</h4>
<p>As there was a mid cycle in Ireland (that doesn't happen very much) we arranged for
a meetup evening for the OpenStack Ireland group.</p>
<p>Myself, <a class="reference external" href="https://twitter.com/timsimmons_">timsim</a>, and <a class="reference external" href="http://twitter.com/ionrock">ionrock</a> gave a a <a class="reference external" href="https://speakerdeck.com/graham/openstack-ireland-meetup-galway-feb-2016">talk</a> about designate and a <em>live demo</em> <a class="footnote-reference" href="posts/designate-mid-cycle/#id4" id="id2">[2]</a></p>
</div>
</div>
<div class="section" id="wednesday">
<h3>Wednesday</h3>
<p>We decided that we should dedicate Wednesday for actaully impmlementing something.
We got a bit done - the start of loading multiple pools into the DB with a sane syntax
(not the crazy stuff we have now),
a scheduler for allowing zones to cross pools, a method of designate services reporting
back with how healthy they are, and some new libraries for tasks like <a class="reference external" href="http://twitter.com/ionrock">ionrock</a>'s <a class="reference external" href="https://github.com/ionrock/taskin">taskin</a> .</p>
</div>
<div class="section" id="thursday">
<h3>Thursday</h3>
<p>We got lost in the floods in the west.</p>
<img alt="http://photos.gra.ham.ie/Designate-Mid-Cycle/i-h4gGtxX/0/O/IMG_3869.jpg" src="http://photos.gra.ham.ie/Designate-Mid-Cycle/i-h4gGtxX/0/O/IMG_3869.jpg"><p><em>The floods</em></p>
<img alt="http://photos.gra.ham.ie/Designate-Mid-Cycle/i-StRbDp8/0/O/IMG_3871.jpg" src="http://photos.gra.ham.ie/Designate-Mid-Cycle/i-StRbDp8/0/O/IMG_3871.jpg"><p><em>Us trying to figure out how to get out</em></p>
<img alt="http://photos.gra.ham.ie/Designate-Mid-Cycle/i-wRQhhwZ/0/O/IMG_3879.jpg" src="http://photos.gra.ham.ie/Designate-Mid-Cycle/i-wRQhhwZ/0/O/IMG_3879.jpg"><p><em>We did get to see the</em> <a class="reference external" href="http://https://en.wikipedia.org/wiki/The_Burren">burren</a> <em>though</em></p>
<table class="docutils footnote" frame="void" id="id3" rules="none">
<colgroup>
<col class="label">
<col>
</colgroup>
<tbody valign="top"><tr>
<td class="label"><a class="fn-backref" href="posts/designate-mid-cycle/#id1">[1]</a></td>
<td>I may or may not have written a oslo.messaging shim in C# previously. Lets not talk about that. It still hurts.</td>
</tr></tbody>
</table>
<table class="docutils footnote" frame="void" id="id4" rules="none">
<colgroup>
<col class="label">
<col>
</colgroup>
<tbody valign="top"><tr>
<td class="label"><a class="fn-backref" href="posts/designate-mid-cycle/#id2">[2]</a></td>
<td>Never do live demos. I had bug filed during this demo, based on something I did on a projector screen. Seriously, record it and hit play.</td>
</tr></tbody>
</table>
<!-- Links -->
</div>
</div>
</div>
            </div>
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/kosmos-mid-cycle/">Kosmos Mid Cycle</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2016-01-29T18:14:05+00:00">2016-01-29 18:14</time>
</div>
                <div class="stats">
                                <a href="posts/kosmos-mid-cycle/#disqus_thread" data-disqus-identifier="cache/posts/kosmos-mid-cycle.html">Comments</a>


                </div>
                        <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/openstack/" rel="tag">openstack</a></li>
           <li><a class="tag p-category" href="categories/seattle/" rel="tag">seattle</a></li>
           <li><a class="tag p-category" href="categories/summit/" rel="tag">summit</a></li>
           <li><a class="tag p-category" href="categories/travel/" rel="tag">travel</a></li>
        </ul>
</div>

            </div>
            <div class="body">
                <div>
<img alt="https://upload.wikimedia.org/wikipedia/commons/5/58/Seattle_Center_as_night_falls.jpg" src="https://upload.wikimedia.org/wikipedia/commons/5/58/Seattle_Center_as_night_falls.jpg"><p><a class="footnote-reference" href="posts/kosmos-mid-cycle/#id2" id="id1">[1]</a></p>
<div class="section" id="kosmos-mid-cycle">
<h2>Kosmos Mid Cycle</h2>
<p>We sat down in Seattle last week to plan out how we were going to kick start
progess on Kosmos</p>
<p>(For those of you who don't know what Kosmos is - here is the overview <a class="reference external" href="https://wiki.openstack.org/wiki/Kosmos">on the wiki</a> )</p>
<p>We decided on a few things, I managed to clarify my (admitedly weird and convaluted) thought process, and we started on the inital sets of patches.</p>
<p>It was a small group - some people were sick from the LBaaS / VPN / FW mid cycle the week before, but enough to start.</p>
<p>We covered the DB, the layout, and how we will interact with it. I showed our basic use of the olso_versionedobjects lib, and the basic pecan framework that was in place.</p>
<p>We have the basic design up on our specs repo <a class="reference external" href="https://github.com/openstack/kosmos-specs">here</a> ( it is not publishing anywhere yet - I will fix that soon )</p>
<p>If anyone is interested in the project, give me a ping - be it for developing drivers, code, requirements or general interest. (But, really - if you want to write code, just jump in, or ping me for what the hot topics are)</p>
<p>In 2 weeks time I will be off the Designate Mid Cycle - a little closer to home this time - in Galway, Ireland.</p>
<table class="docutils footnote" frame="void" id="id2" rules="none">
<colgroup>
<col class="label">
<col>
</colgroup>
<tbody valign="top"><tr>
<td class="label"><a class="fn-backref" href="posts/kosmos-mid-cycle/#id1">[1]</a></td>
<td>By Jeffery Hayes (Jeffery Hayes) [CC BY-SA 3.0 (<a class="reference external" href="http://creativecommons.org/licenses/by-sa/3.0">http://creativecommons.org/licenses/by-sa/3.0</a>)], via Wikimedia Commons</td>
</tr></tbody>
</table>
</div>
</div>
            </div>
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/big-rename-complete/">Big Rename - Complete!!</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2015-11-19T12:49:35+00:00">2015-11-19 12:49</time>
</div>
                <div class="stats">
                                <a href="posts/big-rename-complete/#disqus_thread" data-disqus-identifier="cache/posts/big-rename-complete.html">Comments</a>


                </div>
                        <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/code/" rel="tag">code</a></li>
           <li><a class="tag p-category" href="categories/designate/" rel="tag">designate</a></li>
           <li><a class="tag p-category" href="categories/openstack/" rel="tag">openstack</a></li>
           <li><a class="tag p-category" href="categories/refactor/" rel="tag">refactor</a></li>
        </ul>
</div>

            </div>
            <div class="body">
                <div>
<img alt="http://replygif.net/i/789.gif" src="http://replygif.net/i/789.gif"><div class="section" id="it-is-done">
<h2>It is done !! :)</h2>
<p>So, yesterday Tim and Kiall +2'd the change.</p>
<p>It was quite a bit bigger than expected (+4444, -4230) so thanks to all the
reviewers who put time and effort into checking everything worked, and I hadn't
made any glaring mistakes :).</p>
<p>For anyone interested (or mad) the change is here: <a class="reference external" href="https://review.openstack.org/#/c/244315/">Review</a></p>
</div>
</div>
            </div>
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/the-big-rename/">The Big Rename - why?</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2015-11-09T19:52:03+00:00">2015-11-09 19:52</time>
</div>
                <div class="stats">
                                <a href="posts/the-big-rename/#disqus_thread" data-disqus-identifier="cache/posts/the-big-rename-why.html">Comments</a>


                </div>
                        <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/code/" rel="tag">code</a></li>
           <li><a class="tag p-category" href="categories/designate/" rel="tag">designate</a></li>
           <li><a class="tag p-category" href="categories/openstack/" rel="tag">openstack</a></li>
           <li><a class="tag p-category" href="categories/refactor/" rel="tag">refactor</a></li>
        </ul>
</div>

            </div>
            <div class="body">
                <div>
<div class="section" id="update">
<h2>Update</h2>
<p>Due to unforeseen circumstances I will not be able to continue work on this until
Monday, so we will have to extend the freeze until Tuesday the 17th.</p>
<p>The following message will be put on the patches affected by the freeze.</p>
<p><a class="reference external" href="listings/big-rename-2-update-message.txt.html">big-rename-2-update-message.txt</a></p>
<pre class="code text"><a name="rest_code_c474d5ae4868473bbf5460d8d6403028-1"></a>Due to unforeseen circumstances I will not be able to continue work on this until
<a name="rest_code_c474d5ae4868473bbf5460d8d6403028-2"></a>Monday, so we will have to extend the freeze until Tuesday the 17th.
<a name="rest_code_c474d5ae4868473bbf5460d8d6403028-3"></a>
<a name="rest_code_c474d5ae4868473bbf5460d8d6403028-4"></a>On Tuesday 2015-11-17 this -2 will be removed, and code review as normal will continue.
<a name="rest_code_c474d5ae4868473bbf5460d8d6403028-5"></a>
<a name="rest_code_c474d5ae4868473bbf5460d8d6403028-6"></a>I apologise for the delay, and will get this completed ASAP.
<a name="rest_code_c474d5ae4868473bbf5460d8d6403028-7"></a>
<a name="rest_code_c474d5ae4868473bbf5460d8d6403028-8"></a>Further updates will be posted to http://graham.hayes.ie/posts/the-big-rename/
</pre>
<img alt="https://upload.wikimedia.org/wikipedia/commons/1/1a/Code.jpg" src="https://upload.wikimedia.org/wikipedia/commons/1/1a/Code.jpg"><p><a class="footnote-reference" href="posts/the-big-rename/#id2" id="id1">[1]</a></p>
</div>
<div class="section" id="the-big-rename">
<h2>The Big Rename</h2>
<p>So from tomorrow (2015-11-10) until Friday (2015-11-13) Designate will be frozen for new code.</p>
<p>I send an email to the openstack-dev list before the summit <a class="reference external" href="http://lists.openstack.org/pipermail/openstack-dev/2015-October/077442.html">[2]</a> so, it shouldn't be a surprise (I hope)</p>
<p>So, why are we doing this?</p>
<p>When Designate started it had a v1 API, which used the term domains for DNS Domains. This was pre Keystone's Domain support, but unfortunately they also decided to use it. AS Designate was not even incubated at the time, there was not much we could do, but continue on.</p>
<p>When we started the v2 API, we decided to avoid confusion and expose "Domains" as "Zones".</p>
<p>This worked for a while, but as we worked on the V2 API, we had to write code to translate the internal code (which referenced Domains) to Zones. this caused code like:</p>
<p><a class="reference external" href="listings/big-rename-render.py.html">big-rename-render.py</a></p>
<pre class="code python"><a name="rest_code_e9b9de7eff144befa287c23ce304098f-1"></a><span class="k">def</span> <span class="nf">_render_object</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="nb">object</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a name="rest_code_e9b9de7eff144befa287c23ce304098f-2"></a>    <span class="c1"># The dict we will return to be rendered to JSON / output format</span>
<a name="rest_code_e9b9de7eff144befa287c23ce304098f-3"></a>    <span class="n">r_obj</span> <span class="o">=</span> <span class="p">{}</span>
<a name="rest_code_e9b9de7eff144befa287c23ce304098f-4"></a>    <span class="c1"># Loop over all fields that are supposed to be output</span>
<a name="rest_code_e9b9de7eff144befa287c23ce304098f-5"></a>    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">cls</span><span class="o">.</span><span class="n">MODIFICATIONS</span><span class="p">[</span><span class="s1">'fields'</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a name="rest_code_e9b9de7eff144befa287c23ce304098f-6"></a>        <span class="c1"># Get properties for this field</span>
<a name="rest_code_e9b9de7eff144befa287c23ce304098f-7"></a>        <span class="n">field_props</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="n">MODIFICATIONS</span><span class="p">[</span><span class="s1">'fields'</span><span class="p">][</span><span class="n">key</span><span class="p">]</span>
<a name="rest_code_e9b9de7eff144befa287c23ce304098f-8"></a>        <span class="c1"># Check if it has to be renamed</span>
<a name="rest_code_e9b9de7eff144befa287c23ce304098f-9"></a>        <span class="k">if</span> <span class="n">field_props</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'rename'</span><span class="p">,</span> <span class="bp">False</span><span class="p">):</span>
<a name="rest_code_e9b9de7eff144befa287c23ce304098f-10"></a>            <span class="n">obj</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="nb">object</span><span class="p">,</span> <span class="n">field_props</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'rename'</span><span class="p">))</span>
<a name="rest_code_e9b9de7eff144befa287c23ce304098f-11"></a>            <span class="c1"># if rename is specified we need to change the key</span>
<a name="rest_code_e9b9de7eff144befa287c23ce304098f-12"></a>            <span class="n">obj_key</span> <span class="o">=</span> <span class="n">field_props</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'rename'</span><span class="p">)</span>
<a name="rest_code_e9b9de7eff144befa287c23ce304098f-13"></a>        <span class="k">else</span><span class="p">:</span>
<a name="rest_code_e9b9de7eff144befa287c23ce304098f-14"></a>            <span class="c1"># if not, move on</span>
<a name="rest_code_e9b9de7eff144befa287c23ce304098f-15"></a>            <span class="n">obj</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="nb">object</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<a name="rest_code_e9b9de7eff144befa287c23ce304098f-16"></a>            <span class="n">obj_key</span> <span class="o">=</span> <span class="n">key</span>
</pre>
<p>and</p>
<p><a class="reference external" href="listings/big-rename-error-render.py.html">big-rename-error-render.py</a></p>
<pre class="code python"><a name="rest_code_1961866c473a473191883a5b0e6e3415-1"></a><span class="nd">@classmethod</span>
<a name="rest_code_1961866c473a473191883a5b0e6e3415-2"></a><span class="k">def</span> <span class="nf">_rename_path_segment</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">obj_adapter</span><span class="p">,</span> <span class="nb">object</span><span class="p">,</span> <span class="n">path_segment</span><span class="p">):</span>
<a name="rest_code_1961866c473a473191883a5b0e6e3415-3"></a>
<a name="rest_code_1961866c473a473191883a5b0e6e3415-4"></a>    <span class="c1"># Check if the object is a list - lists will just have an index as a</span>
<a name="rest_code_1961866c473a473191883a5b0e6e3415-5"></a>    <span class="c1"># value, ands this can't be renamed</span>
<a name="rest_code_1961866c473a473191883a5b0e6e3415-6"></a>    <span class="k">if</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">obj_adapter</span><span class="o">.</span><span class="n">ADAPTER_OBJECT</span><span class="p">,</span> <span class="n">objects</span><span class="o">.</span><span class="n">ListObjectMixin</span><span class="p">):</span>
<a name="rest_code_1961866c473a473191883a5b0e6e3415-7"></a>        <span class="n">obj_adapter</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="n">get_object_adapter</span><span class="p">(</span>
<a name="rest_code_1961866c473a473191883a5b0e6e3415-8"></a>            <span class="n">cls</span><span class="o">.</span><span class="n">ADAPTER_FORMAT</span><span class="p">,</span>
<a name="rest_code_1961866c473a473191883a5b0e6e3415-9"></a>            <span class="n">obj_adapter</span><span class="o">.</span><span class="n">ADAPTER_OBJECT</span><span class="o">.</span><span class="n">LIST_ITEM_TYPE</span><span class="o">.</span><span class="n">obj_name</span><span class="p">())</span>
<a name="rest_code_1961866c473a473191883a5b0e6e3415-10"></a>        <span class="c1"># Return the segment as is, and the next adapter (which is the</span>
<a name="rest_code_1961866c473a473191883a5b0e6e3415-11"></a>        <span class="c1"># LIST_ITEM_TYPE)</span>
<a name="rest_code_1961866c473a473191883a5b0e6e3415-12"></a>        <span class="k">return</span> <span class="n">path_segment</span><span class="p">,</span> <span class="n">obj_adapter</span>
<a name="rest_code_1961866c473a473191883a5b0e6e3415-13"></a>
<a name="rest_code_1961866c473a473191883a5b0e6e3415-14"></a>    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">obj_adapter</span><span class="o">.</span><span class="n">MODIFICATIONS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
<a name="rest_code_1961866c473a473191883a5b0e6e3415-15"></a>            <span class="s1">'fields'</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a name="rest_code_1961866c473a473191883a5b0e6e3415-16"></a>
<a name="rest_code_1961866c473a473191883a5b0e6e3415-17"></a>        <span class="c1"># Check if this field as actually a nested object</span>
<a name="rest_code_1961866c473a473191883a5b0e6e3415-18"></a>        <span class="k">if</span> <span class="nb">object</span><span class="o">.</span><span class="n">FIELDS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">path_segment</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'relation'</span><span class="p">,</span> <span class="bp">False</span><span class="p">):</span>
<a name="rest_code_1961866c473a473191883a5b0e6e3415-19"></a>
<a name="rest_code_1961866c473a473191883a5b0e6e3415-20"></a>            <span class="n">obj_cls</span> <span class="o">=</span> <span class="nb">object</span><span class="o">.</span><span class="n">FIELDS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">path_segment</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'relation_cls'</span><span class="p">)</span>
<a name="rest_code_1961866c473a473191883a5b0e6e3415-21"></a>            <span class="n">obj_adapter</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="n">get_object_adapter</span><span class="p">(</span>
<a name="rest_code_1961866c473a473191883a5b0e6e3415-22"></a>                <span class="n">cls</span><span class="o">.</span><span class="n">ADAPTER_FORMAT</span><span class="p">,</span>
<a name="rest_code_1961866c473a473191883a5b0e6e3415-23"></a>                <span class="n">obj_cls</span><span class="p">)</span>
<a name="rest_code_1961866c473a473191883a5b0e6e3415-24"></a>
<a name="rest_code_1961866c473a473191883a5b0e6e3415-25"></a>            <span class="nb">object</span> <span class="o">=</span> <span class="n">objects</span><span class="o">.</span><span class="n">DesignateObject</span><span class="o">.</span><span class="n">obj_cls_from_name</span><span class="p">(</span><span class="n">obj_cls</span><span class="p">)()</span>
<a name="rest_code_1961866c473a473191883a5b0e6e3415-26"></a>            <span class="c1"># Recurse down into this object</span>
<a name="rest_code_1961866c473a473191883a5b0e6e3415-27"></a>            <span class="n">path_segment</span><span class="p">,</span> <span class="n">obj_adapter</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="n">_rename_path_segment</span><span class="p">(</span>
<a name="rest_code_1961866c473a473191883a5b0e6e3415-28"></a>                <span class="n">obj_adapter</span><span class="p">,</span> <span class="nb">object</span><span class="p">,</span> <span class="n">path_segment</span><span class="p">)</span>
<a name="rest_code_1961866c473a473191883a5b0e6e3415-29"></a>
<a name="rest_code_1961866c473a473191883a5b0e6e3415-30"></a>            <span class="c1"># No need to continue the loop</span>
<a name="rest_code_1961866c473a473191883a5b0e6e3415-31"></a>            <span class="k">break</span>
<a name="rest_code_1961866c473a473191883a5b0e6e3415-32"></a>
<a name="rest_code_1961866c473a473191883a5b0e6e3415-33"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span>
<a name="rest_code_1961866c473a473191883a5b0e6e3415-34"></a>            <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
<a name="rest_code_1961866c473a473191883a5b0e6e3415-35"></a>                <span class="s1">'rename'</span><span class="p">,</span> <span class="n">NotSpecifiedSential</span><span class="p">()),</span> <span class="n">NotSpecifiedSential</span><span class="p">)</span>\
<a name="rest_code_1961866c473a473191883a5b0e6e3415-36"></a>                <span class="ow">and</span> <span class="n">path_segment</span> <span class="o">==</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'rename'</span><span class="p">):</span>
<a name="rest_code_1961866c473a473191883a5b0e6e3415-37"></a>            <span class="c1"># Just do the rename</span>
<a name="rest_code_1961866c473a473191883a5b0e6e3415-38"></a>            <span class="n">path_segment</span> <span class="o">=</span> <span class="n">key</span>
<a name="rest_code_1961866c473a473191883a5b0e6e3415-39"></a>
<a name="rest_code_1961866c473a473191883a5b0e6e3415-40"></a>    <span class="k">return</span> <span class="n">path_segment</span><span class="p">,</span> <span class="n">obj_adapter</span>
</pre>
<p>which proved to be quite fragile. (Yes that last bit of code is trying to walk the error path of a JSONSchema Error and rename the path to the new terminology)</p>
<p>We are also logging messages about domains - which could prove to be quite confusing when we remove the v1 API and users are only interacting with zones.</p>
<p>So tomorrow morning-ish (UTC) we will start to rename every occurrence of "domain" in the code base to "zone" (without breaking Keystone domain support).</p>
<p>Anything that does not have the "the-big-rename" topic on Gerrit will be getting a procedural -2 from me or the designate-core team.</p>
<p><a class="reference external" href="listings/big-rename-2-message.txt.html">big-rename-2-message.txt</a></p>
<pre class="code text"><a name="rest_code_f6e1f2e8f23e4ca2a1acfe07248520b1-1"></a>Currently Designate is undergoing a code freeze to allow us re-factor the code base,
<a name="rest_code_f6e1f2e8f23e4ca2a1acfe07248520b1-2"></a>as announced here: - http://lists.openstack.org/pipermail/openstack-dev/2015-October/077442.html
<a name="rest_code_f6e1f2e8f23e4ca2a1acfe07248520b1-3"></a>
<a name="rest_code_f6e1f2e8f23e4ca2a1acfe07248520b1-4"></a>All code that is not in the "the-big-rename" topic will be getting this procedural -2.
<a name="rest_code_f6e1f2e8f23e4ca2a1acfe07248520b1-5"></a>
<a name="rest_code_f6e1f2e8f23e4ca2a1acfe07248520b1-6"></a>More information can be found here: - http://graham.hayes.ie/posts/the-big-rename/
<a name="rest_code_f6e1f2e8f23e4ca2a1acfe07248520b1-7"></a>
<a name="rest_code_f6e1f2e8f23e4ca2a1acfe07248520b1-8"></a>On Friday 2015-11-13 this -2 will be removed, and code review as normal will continue.
<a name="rest_code_f6e1f2e8f23e4ca2a1acfe07248520b1-9"></a>
<a name="rest_code_f6e1f2e8f23e4ca2a1acfe07248520b1-10"></a>This re-factor will break the majority of patches that are outstanding, and you may need to manually
<a name="rest_code_f6e1f2e8f23e4ca2a1acfe07248520b1-11"></a>rebase your patch when we remove the -2.
</pre>
<table class="docutils footnote" frame="void" id="id2" rules="none">
<colgroup>
<col class="label">
<col>
</colgroup>
<tbody valign="top"><tr>
<td class="label"><a class="fn-backref" href="posts/the-big-rename/#id1">[1]</a></td>
<td>By Crusher95 (Own work) [CC BY-SA 4.0 (<a class="reference external" href="http://creativecommons.org/licenses/by-sa/4.0">http://creativecommons.org/licenses/by-sa/4.0</a>)], via Wikimedia Commons</td>
</tr></tbody>
</table>
</div>
</div>
            </div>
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/openstack-summit-designate-report/">OpenStack Summit - Designate Report</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2015-11-04T21:18:41+00:00">2015-11-04 21:18</time>
</div>
                <div class="stats">
                                <a href="posts/openstack-summit-designate-report/#disqus_thread" data-disqus-identifier="cache/posts/openstack-summit-designate-report.html">Comments</a>


                </div>
                        <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/openstack/" rel="tag">openstack</a></li>
           <li><a class="tag p-category" href="categories/summit/" rel="tag">summit</a></li>
           <li><a class="tag p-category" href="categories/tokyo/" rel="tag">tokyo</a></li>
           <li><a class="tag p-category" href="categories/travel/" rel="tag">travel</a></li>
        </ul>
</div>

            </div>
            <div class="body">
                <div>
<img alt="https://upload.wikimedia.org/wikipedia/commons/7/70/Ginza_at_Night,_Tokyo.jpg" src="https://upload.wikimedia.org/wikipedia/commons/7/70/Ginza_at_Night,_Tokyo.jpg"><p><a class="footnote-reference" href="posts/openstack-summit-designate-report/#id2" id="id1">[1]</a></p>
<div class="section" id="tokyo">
<h2>Tokyo</h2>
<p>Oh, what a place. I thought I was ready for the experience, but this city has
to be visited to understand. From the 2 or 3 different metro systems that snake
across the city, to the 9 story electronics stores, it is something else.</p>
<p>Living in a city that has 3 metro lines that don't actually connect it was a nice
change to be able to get reliable public transport :).</p>
</div>
<div class="section" id="design-summit">
<h2>Design Summit</h2>
<p>This was a much more relaxed summit for Designate. We had done a huge amount of
work in Vancouver, and we were nailing down details and doing cross project work.</p>
<p>We got a few major features discussed, and laid out our priorities for the next cycle.</p>
<p>We decided on the following:</p>
<ol class="arabic simple">
<li>Nova / Neutron Integration</li>
<li>Pool Scheduler</li>
<li>Pool Configuration migration to database</li>
<li>IXFR (Incremental Zone Transfer)</li>
<li>ALIAS Record type (Allows for CNAME like records at the root of a DNS Zone)</li>
<li>DNSSEC (this may drag on for a cycle or two)</li>
</ol>
<div class="section" id="nova-neutron-integration">
<h3>Nova &amp; Neutron Integration</h3>
<p>This is progressing pretty well, and Miguel Lavalle has patches up for this. He,
Kiall Mac Innes and Carl Baldwin demoed this in a session on the Thursday. If
you are interested in the idea, it is definitely worth a watch <a class="reference external" href="http://https://www.youtube.com/watch?v=AZbiARM9FPM">here</a></p>
</div>
<div class="section" id="pool-scheduler">
<h3>Pool Scheduler</h3>
<p>A vital piece of the pools re architecture that needs to be finished out.
There is no great debate on what we need, and I have taken on the task of
finishing this out.</p>
</div>
<div class="section" id="pool-configuration-migration-to-database">
<h3>Pool Configuration migration to database</h3>
<p>Are current configuration file format is quite complex, and moving it to an API
allows us to iterate on it much quicker, while reducing the complexity of the
config file. I recently had to write an ansible play to write out this file, and
it was not fun.</p>
<p>Kiall had a patch up, so we should be able to continue based on that.</p>
</div>
<div class="section" id="ixfr">
<h3>IXFR</h3>
<p>There was quite a lot of discussion on how this will be implemented, both in the
work session, and the 1/2 day session on the Friday. Tim Simmons has stepped up,
to continue the work on this.</p>
</div>
<div class="section" id="alias">
<h3>ALIAS</h3>
<p>This is quite a sort after feature - but is quite complex to implement.
The DNS RFCs explicitly ban this behavior, so we have to work the solution
around them. Eric Larson has been doing quite a lot of work on this in Liberty,
and is going to continue in Mitaka.</p>
</div>
<div class="section" id="dnssec">
<h3>DNSSEC</h3>
<p>This is a feature that we have been looking at for a while, but we started to plan
out our roadmap for it recently.</p>
<p>We (I) am allergic to storing private encryption keys in Designate, so we had a
good conversation with Barbican about implementing a signing endpoint that we would
post a hash to. This work is on me to now drive for Mitaka, so we can consume it in N.</p>
<p>There is some raw notes in the <a class="reference external" href="https://etherpad.openstack.org/p/mitaka-designate-summit-roadmap">etherpad</a> and I expect we will soon be seeing
specs building out of them.</p>
<table class="docutils footnote" frame="void" id="id2" rules="none">
<colgroup>
<col class="label">
<col>
</colgroup>
<tbody valign="top"><tr>
<td class="label"><a class="fn-backref" href="posts/openstack-summit-designate-report/#id1">[1]</a></td>
<td>By Francisco Diez (Flickr: Ginza at Night, Tokyo) [CC BY 2.0 (<a class="reference external" href="http://creativecommons.org/licenses/by/2.0">http://creativecommons.org/licenses/by/2.0</a>)], via Wikimedia Commons</td>
</tr></tbody>
</table>
</div>
</div>
</div>
            </div>
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/starting-blogging-again/">Starting Blogging (Again)</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2015-11-04T21:12:13+00:00">2015-11-04 21:12</time>
</div>
                <div class="stats">
                                <a href="posts/starting-blogging-again/#disqus_thread" data-disqus-identifier="cache/posts/starting-blogging-again.html">Comments</a>


                </div>
                        <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/intro/" rel="tag">intro</a></li>
           <li><a class="tag p-category" href="categories/welcome/" rel="tag">welcome</a></li>
        </ul>
</div>

            </div>
            <div class="body">
                <div>
<p>Having taken a year or two hiatus on blogging, I have decided to give it
another shot.</p>
<p>A lot has happened since then, and recently I have started to do more and more
work in upstream OpenStack. Starting as a PTL I thought it might be useful to
have somewhere for me to rant, rave, and generally explain my (admittedly from
time to time bizarre) thought process.</p>
<p>I reckon there will be flurries of activity here, followed by silence, but we
shall see what happens in time :)</p>
</div>
            </div>
        </div>
    
                   <script>var disqus_shortname="grahamhayesie";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script><footer id="footer"><p>Contents © 2016         <a href="mailto:graham@hayes.ie">Graham Hayes</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         </p>
            
        </footer>
</div>
    </section><script src="assets/js/all-nocdn.js" type="text/javascript"></script><script type="text/javascript">
            $(function(){
                $('.timeago').timeago();
            });
        </script><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-23042579-7', 'auto');
  ga('send', 'pageview');

</script>
</body>
</html>
